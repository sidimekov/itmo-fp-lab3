# Лабораторная работа 3

Сидимеков Дмитрий P3322

## Цель работы

Разработать консольное приложение на OCaml для потоковой интерполяции численных данных. Программа должна принимать данные через стандартный ввод, обрабатывать их по мере поступления и выводить результаты в стандартный вывод. Управление поведением осуществляется через аргументы командной строки

## Требования

Входные данные подаются через stdin в текстовом виде. Каждая строка содержит пару чисел x и y. В качестве разделителей допускаются пробел, табуляция, запятая и точка с запятой. Входные точки отсортированы по возрастанию x.

Поддерживаются следующие алгоритмы интерполяции:

- **Линейная интерполяция** между соседними точками
- **Интерполяция Ньютона** по фиксированному числу точек

Параметры работы задаются через аргументы командной строки:

- выбор одного или нескольких алгоритмов
- шаг дискретизации результирующих данных
- размер окна для интерполяции Ньютона

Программа работает в потоковом режиме. Результаты вычислений выводятся по мере накопления достаточного количества входных данных без ожидания конца входного потока.

## Описание алгоритмов

Линейная интерполяция использует две соседние входные точки и аппроксимирует функцию линейным отрезком между ними. Вычисление значений происходит на равномерной сетке по x

Интерполяция Ньютона строит интерполяционный многочлен по набору из n точек. В потоковом режиме используется скользящее окно из последних n точек. Вывод значений производится преимущественно в центральной части окна, где результат наиболее устойчив

## Ключевые элементы реализации

Модуль `interp.ml` содержит чистые функции интерполяции. В нем описан тип точки и реализованы алгоритмы линейной интерполяции и интерполяции Ньютона. Все функции в этом модуле не используют ввод или вывод и работают только с переданными аргументами.

Модуль `engine.ml` описывает общий интерфейс алгоритмов и вспомогательные функции для офлайн вычислений. Он не участвует в потоковой обработке, но используется для логического разделения вычислительной части.

Модуль `stream.ml` содержит обобщенную реализацию потоковой обработки. В нем определен общий механизм стрима и интерфейс алгоритма интерполяции. Линейная интерполяция и интерполяция Ньютона реализованы как параметры этого механизма.

Файл `my_lab3.ml` содержит логику работы с вводом и выводом. В нем реализован разбор аргументов командной строки, чтение входных данных из stdin и печать результатов в stdout.

Для каждого алгоритма поддерживается собственное состояние, формируемое модулем стрима. Состояние передается между шагами обработки как аргумент рекурсивной функции, без использования мутабельных переменных

Потоковая обработка реализована через явное хранение и обновление состояния стрима. При поступлении новой точки состояние обновляется и если возможно, вычисляются новые интерполированные значения. При завершении входного потока производится финальный вывод оставшихся данных

## Ввод и вывод программы

Пример запуска линейной интерполяции:

```sh
printf "0 0\n1 1\n2 2\n" | dune exec ./bin/my_lab3.exe -- --linear --step 0.7
```

```
linear: 0 0
linear: 0.7 0.7
linear: 1.4 1.4
```

Пример запуска интерполяции Ньютона:

```sh
printf "0 0\n1 1\n2 2\n3 3\n4 4\n" | dune exec ./bin/my_lab3.exe -- --newton -n 4 --step 0.5
```

```
newton: 0 0
newton: 0.5 0.5
newton: 1 1
newton: 1.5 1.5
newton: 2 2
newton: 2.5 2.5
newton: 3 3
newton: 3.5 3.5
newton: 4 4
```

## Выводы

В ходе выполнения работы были применены основные принципы функционального программирования. Разделение вычислительной логики и ввода вывода упростило структуру программы и повысило ее читаемость. Потоковая модель обработки данных позволила реализовать интерполяцию без хранения всего набора входных точек в памяти
